(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{118:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return i})),n.d(t,"metadata",(function(){return o})),n.d(t,"toc",(function(){return c})),n.d(t,"default",(function(){return l}));var r=n(3),a=n(7),s=(n(0),n(273)),i={title:"Grupos y Permisos"},o={unversionedId:"authentication-and-access-control/groups-and-permissions",id:"authentication-and-access-control/groups-and-permissions",isDocsHomePage:!1,title:"Grupos y Permisos",description:"In advanced applications, access control can be managed through permissions and groups.",source:"@site/i18n/es/docusaurus-plugin-content-docs/current/authentication-and-access-control/groups-and-permissions.md",slug:"/authentication-and-access-control/groups-and-permissions",permalink:"/es/docs/authentication-and-access-control/groups-and-permissions",editUrl:"https://github.com/FoalTS/foal/edit/master/docs/i18n/es/docusaurus-plugin-content-docs/current/authentication-and-access-control/groups-and-permissions.md",version:"current",sidebar:"someSidebar",previous:{title:"Administradores & Roles",permalink:"/es/docs/authentication-and-access-control/administrators-and-roles"},next:{title:"API REST",permalink:"/es/docs/api-section/rest-blueprints"}},c=[{value:"Permissions",id:"permissions",children:[{value:"The <code>Permission</code> Entity",id:"the-permission-entity",children:[]},{value:"Creating Permissions Programmatically",id:"creating-permissions-programmatically",children:[]},{value:"Creating Permissions with a Shell Script (CLI)",id:"creating-permissions-with-a-shell-script-cli",children:[]}]},{value:"Groups",id:"groups",children:[{value:"The Group Entity",id:"the-group-entity",children:[]},{value:"Creating Groups Programmatically",id:"creating-groups-programmatically",children:[]},{value:"Creating Groups with a Shell Script (CLI)",id:"creating-groups-with-a-shell-script-cli",children:[]}]},{value:"Users",id:"users",children:[{value:"The <code>UserWithPermissions</code> Entity",id:"the-userwithpermissions-entity",children:[]},{value:"The <code>hasPerm</code> Method",id:"the-hasperm-method",children:[]},{value:"Creating Users with Groups and Permissions with a Shell Script (CLI)",id:"creating-users-with-groups-and-permissions-with-a-shell-script-cli",children:[]}]},{value:"Fetching a User with their Permissions",id:"fetching-a-user-with-their-permissions",children:[]},{value:"The PermissionRequired Hook",id:"the-permissionrequired-hook",children:[]},{value:"BaseEntity Inheritance",id:"baseentity-inheritance",children:[]},{value:"Get All Users with a Given Permission",id:"get-all-users-with-a-given-permission",children:[]}],p={toc:c};function l(e){var t=e.components,i=Object(a.a)(e,["components"]);return Object(s.b)("wrapper",Object(r.a)({},p,i,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,"In advanced applications, access control can be managed through permissions and groups."),Object(s.b)("p",null,"A ",Object(s.b)("em",{parentName:"p"},"permission")," gives a user the right to perform a given action (such as accessing a route)."),Object(s.b)("p",null,"A ",Object(s.b)("em",{parentName:"p"},"group")," brings together a set of users (a user can belong to more than one group)."),Object(s.b)("p",null,"Permissions can be attached to a user or a group. Attaching a permission to a group is equivalent to attaching the permission to each of its users."),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"Examples of ",Object(s.b)("em",{parentName:"p"},"groups"),' are the "Free", "Pro" and "Enterprise" plans of a SaaS application. Depending of the price paid by the customers, they have access to certain features whose access are managed by ',Object(s.b)("em",{parentName:"p"},"permissions"),".")),Object(s.b)("h2",{id:"permissions"},"Permissions"),Object(s.b)("h3",{id:"the-permission-entity"},"The ",Object(s.b)("inlineCode",{parentName:"h3"},"Permission")," Entity"),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Property name"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Type"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Database Link"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"id"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"number"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Primary auto generated key")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"name"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"string"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}))),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"codeName"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"string"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Unique, Length: 100")))),Object(s.b)("h3",{id:"creating-permissions-programmatically"},"Creating Permissions Programmatically"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { Permission } from './src/app/entities';\n\nasync function main() {\n  const perm = new Permission();\n  perm.codeName = 'secret-perm';\n  perm.name = 'Permission to access the secret';\n  await perm.save();\n}\n")),Object(s.b)("h3",{id:"creating-permissions-with-a-shell-script-cli"},"Creating Permissions with a Shell Script (CLI)"),Object(s.b)("p",null,"Create a new script with this command:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{}),"foal generate script create-perm\n")),Object(s.b)("p",null,"Replace the content of the new created file ",Object(s.b)("inlineCode",{parentName:"p"},"src/scripts/create-perm.ts")," with the following:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"// 3p\nimport { Permission } from '@foal/typeorm';\nimport { createConnection, getConnection } from 'typeorm';\n\nexport const schema = {\n  additionalProperties: false,\n  properties: {\n    codeName: { type: 'string', maxLength: 100 },\n    name: { type: 'string' },\n  },\n  required: [ 'name', 'codeName' ],\n  type: 'object',\n};\n\nexport async function main(args: { codeName: string, name: string }) {\n  const permission = new Permission();\n  permission.codeName = args.codeName;\n  permission.name = args.name;\n\n  await createConnection();\n\n  try {\n    console.log(\n      await permission.save();\n    );\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    await getConnection().close();\n  }\n}\n")),Object(s.b)("p",null,"Then you can create a permission through the command line."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-sh"}),'npm run build\nfoal run create-perm name="Permission to access the secret" codeName="access-secret"\n')),Object(s.b)("h2",{id:"groups"},"Groups"),Object(s.b)("p",null,"Groups are used to categorize users. A user can belong to several groups and a group can have several users."),Object(s.b)("p",null,"A group can have permissions. They then apply to all its users."),Object(s.b)("h3",{id:"the-group-entity"},"The Group Entity"),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Property name"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Type"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Database Link"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"id"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"number"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Primary auto generated key")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"name"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"string"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Length: 80")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"codeName"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"string"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Unique, Length: 100")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"permissions"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Permission[]"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"A many-to-many relation with the table permission")))),Object(s.b)("h3",{id:"creating-groups-programmatically"},"Creating Groups Programmatically"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { Group, Permission } from './src/app/entities';\n\nasync function main() {\n  const perm = new Permission();\n  perm.codeName = 'delete-users';\n  perm.name = 'Permission to delete users';\n  await perm.save();\n\n  const group = new Group();\n  group.codeName = 'admin';\n  group.name = 'Administrators';\n  group.permissions = [ perm ];\n  await group.save();\n}\n")),Object(s.b)("h3",{id:"creating-groups-with-a-shell-script-cli"},"Creating Groups with a Shell Script (CLI)"),Object(s.b)("p",null,"Create a new script with this command:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{}),"foal generate script create-group\n")),Object(s.b)("p",null,"Replace the content of the new created file ",Object(s.b)("inlineCode",{parentName:"p"},"src/scripts/create-group.ts")," with the following:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"// 3p\nimport { Group, Permission } from '@foal/typeorm';\nimport { createConnection } from 'typeorm';\n\nexport const schema = {\n  additionalProperties: false,\n  properties: {\n    codeName: { type: 'string', maxLength: 100 },\n    name: { type: 'string', maxLength: 80 },\n    permissions: { type: 'array', items: { type: 'string' }, uniqueItems: true, default: [] }\n  },\n  required: [ 'name', 'codeName' ],\n  type: 'object',\n};\n\nexport async function main(args: { codeName: string, name: string, permissions: string[] }) {\n  const group = new Group();\n  group.permissions = [];\n  group.codeName = args.codeName;\n  group.name = args.name;\n\n  const connection = await createConnection();\n  try {\n    for (const codeName of args.permissions) {\n      const permission = await Permission.findOne({ codeName });\n      if (!permission) {\n        console.log(\n          `No permission with the code name \"${codeName}\" was found.`\n        );\n        return;\n      }\n      group.permissions.push(permission);\n    }\n\n    console.log(\n      await group.save()\n    );\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    await connection.close();\n  }\n}\n\n")),Object(s.b)("p",null,"Then you can create a group through the command line."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-sh"}),'npm run build\nfoal run create-perm name="Permission to delete users" codeName="delete-users"\nfoal run create-group name="Administrators" codeName="admin" permissions="[ \\"delete-users\\" ]"\n')),Object(s.b)("h2",{id:"users"},"Users"),Object(s.b)("h3",{id:"the-userwithpermissions-entity"},"The ",Object(s.b)("inlineCode",{parentName:"h3"},"UserWithPermissions")," Entity"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { UserWithPermissions } from '@foal/typeorm';\nimport { Entity } from 'typeorm';\n\n@Entity()\nexport class User extends UserWithPermissions {\n\n}\n\n// You MUST export Group and Permission so that TypeORM can generate migrations.\nexport { Group, Permission } from '@foal/typeorm';\n")),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"UserWithPermissions")," is an abstract class that has useful features to handle access control through permissions and groups. You must extend your ",Object(s.b)("inlineCode",{parentName:"p"},"User")," entity from this class to use permissions and groups."),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Property name"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Type"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Database Link"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"id"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"number"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Primary auto generated key")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"groups"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Group[]"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"A many-to-many relation with the table group")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"userPermissions"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Permission[]"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"A many-to-many relation with the table permission")))),Object(s.b)("p",null,Object(s.b)("img",{alt:"Relations between Users, Groups and Permissions",src:n(355).default})),Object(s.b)("h3",{id:"the-hasperm-method"},"The ",Object(s.b)("inlineCode",{parentName:"h3"},"hasPerm")," Method"),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"hasPerm(permissionCodeName: string)")," method of the ",Object(s.b)("inlineCode",{parentName:"p"},"UserWithPermissions")," class returns true if one of these conditions is true:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"The user has the required permission."),Object(s.b)("li",{parentName:"ul"},"The user belongs to a group that has the required permission.")),Object(s.b)("h3",{id:"creating-users-with-groups-and-permissions-with-a-shell-script-cli"},"Creating Users with Groups and Permissions with a Shell Script (CLI)"),Object(s.b)("p",null,"Replace the content of the new created file ",Object(s.b)("inlineCode",{parentName:"p"},"src/scripts/create-user.ts")," with the following:"),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"// 3p\nimport { hashPassword } from '@foal/core';\nimport { Group, Permission } from '@foal/typeorm';\nimport { createConnection, getConnection, getManager } from 'typeorm';\n\n// App\nimport { User } from '../app/entities';\n\nexport const schema = {\n  additionalProperties: false,\n  properties: {\n    email: { type: 'string', format: 'email' },\n    groups: { type: 'array', items: { type: 'string' }, uniqueItems: true, default: [] },\n    password: { type: 'string' },\n    userPermissions: { type: 'array', items: { type: 'string' }, uniqueItems: true, default: [] },\n  },\n  required: [ 'email', 'password' ],\n  type: 'object',\n};\n\nexport async function main(args) {\n  const user = new User();\n  user.userPermissions = [];\n  user.groups = [];\n  user.email = args.email;\n  user.password = await hashPassword(args.password);\n\n  await createConnection();\n\n  for (const codeName of args.userPermissions as string[]) {\n    const permission = await Permission.findOne({ codeName });\n    if (!permission) {\n      console.log(`No permission with the code name \"${codeName}\" was found.`);\n      return;\n    }\n    user.userPermissions.push(permission);\n  }\n\n  for (const codeName of args.groups as string[]) {\n    const group = await Group.findOne({ codeName });\n    if (!group) {\n      console.log(`No group with the code name \"${codeName}\" was found.`);\n      return;\n    }\n    user.groups.push(group);\n  }\n\n  try {\n    console.log(\n      await getManager().save(user)\n    );\n  } catch (error) {\n    console.log(error.message);\n  } finally {\n    await getConnection().close();\n  }\n}\n")),Object(s.b)("p",null,"Then you can create a user with their permissions and groups through the command line."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-sh"}),'npm run build\nfoal run create-user userPermissions="[ \\"my-first-perm\\" ]" groups="[ \\"my-group\\" ]"\n')),Object(s.b)("h2",{id:"fetching-a-user-with-their-permissions"},"Fetching a User with their Permissions"),Object(s.b)("p",null,"If you want the ",Object(s.b)("inlineCode",{parentName:"p"},"hasPerm")," method to work on the context ",Object(s.b)("inlineCode",{parentName:"p"},"user")," property, you must use the ",Object(s.b)("inlineCode",{parentName:"p"},"fetchUserWithPermissions")," function in the authentication hook."),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Example with JSON Web Tokens")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { Context, Get } from '@foal/core';\nimport { JWTRequired } from '@foal/jwt';\nimport { fetchUserWithPermissions } from '@foal/typeorm';\n\n@JWTRequired({\n  user: fetchUserWithPermissions(User)\n})\nexport class ProductController {\n  @Get('/products')\n  readProduct(ctx: Context) {\n    if (!ctx.user.hasPerm('read-products')) {\n      return new HttpResponseForbidden();\n    }\n    return new HttpResponseOK([]);\n  }\n}\n")),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Example with Sessions Tokens")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { Context, Get, UseSessions } from '@foal/core';\nimport { fetchUserWithPermissions, TypeORMStore } from '@foal/typeorm';\n\n@UseSessions({\n  store: TypeORMStore,\n  required: true,\n  user: fetchUserWithPermissions(User)\n})\nexport class ProductController {\n  @Get('/products')\n  readProduct(ctx: Context) {\n    if (!ctx.user.hasPerm('read-products')) {\n      return new HttpResponseForbidden();\n    }\n    return new HttpResponseOK([]);\n  }\n}\n")),Object(s.b)("h2",{id:"the-permissionrequired-hook"},"The PermissionRequired Hook"),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"This requires the use of ",Object(s.b)("inlineCode",{parentName:"p"},"fetchUserWithPermissions"),".")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"@PermissionRequired('perm')\n")),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Context"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Response"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"ctx.user")," is undefined"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"401 - UNAUTHORIZED")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"ctx.user.hasPerm('perm')")," is false"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"403 - FORBIDDEN")))),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"@PermissionRequired('perm', { redirect: '/login' })\n")),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Context"),Object(s.b)("th",Object(r.a)({parentName:"tr"},{align:null}),"Response"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"ctx.user")," is undefined"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"Redirects to ",Object(s.b)("inlineCode",{parentName:"td"},"/login")," (302 - FOUND)")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"ctx.user.hasPerm('perm')")," is false"),Object(s.b)("td",Object(r.a)({parentName:"tr"},{align:null}),"403 - FORBIDDEN")))),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Example")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"import { Context, Get } from '@foal/core';\nimport { fetchUserWithPermissions, PermissionRequired } from '@foal/typeorm';\nimport { JWTRequired } from '@foal/jwt';\n\n@JWTRequired({ user: fetchUserWithPermissions(User) })\nexport class ProductController {\n  @Get('/products')\n  @PermissionRequired('read-products')\n  readProduct(ctx: Context) {\n    return new HttpResponseOK([]);\n  }\n}\n")),Object(s.b)("h2",{id:"baseentity-inheritance"},"BaseEntity Inheritance"),Object(s.b)("p",null,"The classes ",Object(s.b)("inlineCode",{parentName:"p"},"Permission"),", ",Object(s.b)("inlineCode",{parentName:"p"},"Group")," and ",Object(s.b)("inlineCode",{parentName:"p"},"UserWithPermissions")," all extends the ",Object(s.b)("inlineCode",{parentName:"p"},"BaseEntity")," class so you can access its static and instance methods."),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"Example")),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"const perm = await Permission.findOneOrFail({ codeName: 'perm1' });\nperm.name = 'Permission1';\nawait perm.save();\n")),Object(s.b)("h2",{id:"get-all-users-with-a-given-permission"},"Get All Users with a Given Permission"),Object(s.b)("p",null,"The class ",Object(s.b)("inlineCode",{parentName:"p"},"UserWithPermissions")," provides a static method ",Object(s.b)("inlineCode",{parentName:"p"},"withPerm")," to get all users with a given permission. It returns all users that have this permission on their own or through the groups they belong to."),Object(s.b)("pre",null,Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-typescript"}),"@Entity()\nclass User extends UserWithPermissions {}\n  \nconst users = await User.withPerm<User>('perm1');\n")))}l.isMDXComponent=!0},273:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var r=n(0),a=n.n(r);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=a.a.createContext({}),l=function(e){var t=a.a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},b=function(e){var t=l(e.components);return a.a.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},u=a.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),b=l(n),u=r,d=b["".concat(i,".").concat(u)]||b[u]||m[u]||s;return n?a.a.createElement(d,o(o({ref:t},p),{},{components:n})):a.a.createElement(d,o({ref:t},p))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=u;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:r,i[1]=o;for(var p=2;p<s;p++)i[p]=n[p];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},355:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/permissions-groups-and-users-ec7a479e022323aca7ea069ba9622d31.png"}}]);