(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{173:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return l})),t.d(n,"default",(function(){return s}));var o=t(3),r=t(7),a=(t(0),t(269)),i={title:"Ship to Production"},c={unversionedId:"deployment-and-environments/ship-to-production",id:"deployment-and-environments/ship-to-production",isDocsHomePage:!1,title:"Ship to Production",description:"Set the Node.JS environment to production",source:"@site/docs/deployment-and-environments/ship-to-production.md",slug:"/deployment-and-environments/ship-to-production",permalink:"/docs/deployment-and-environments/ship-to-production",editUrl:"https://github.com/FoalTS/foal/edit/master/docs/docs/deployment-and-environments/ship-to-production.md",version:"current",sidebar:"someSidebar",previous:{title:"Configuration",permalink:"/docs/deployment-and-environments/configuration"},next:{title:"Update Guide to Version 2",permalink:"/docs/upgrade-to-v2/README"}},l=[{value:"Set the Node.JS environment to <code>production</code>",id:"set-the-nodejs-environment-to-production",children:[]},{value:"Use HTTPS",id:"use-https",children:[]},{value:"Generate Different Secrets",id:"generate-different-secrets",children:[]},{value:"Database Credentials &amp; Migrations",id:"database-credentials--migrations",children:[]},{value:"Files to Upload",id:"files-to-upload",children:[]}],p={toc:l};function s(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"set-the-nodejs-environment-to-production"},"Set the Node.JS environment to ",Object(a.b)("inlineCode",{parentName:"h2"},"production")),Object(a.b)("p",null,"Set the ",Object(a.b)("inlineCode",{parentName:"p"},"NODE_ENV")," environment variable to ",Object(a.b)("inlineCode",{parentName:"p"},"production"),"."),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"NODE_ENV=production npm run start\n")),Object(a.b)("h2",{id:"use-https"},"Use HTTPS"),Object(a.b)("p",null,"You must use HTTPS to prevent ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Man-in-the-middle_attack"}),"man-in-the-middle attacks"),". Otherwise, your credentials and authentication tokens will appear in clear on the network."),Object(a.b)("p",null,"If you use cookies, make sure to let them only be sent to the server when the request is made using SSL. You can do such thing with the cookie ",Object(a.b)("inlineCode",{parentName:"p"},"secure")," directive."),Object(a.b)("p",null,Object(a.b)("em",{parentName:"p"},"config/production.yml (example)")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-yaml"}),"settings:\n  // If you use sessions\n  session:\n    cookie:\n      secure: true\n  // If you use JWT\n  jwt:\n    cookie:\n      secure: true\n")),Object(a.b)("h2",{id:"generate-different-secrets"},"Generate Different Secrets"),Object(a.b)("p",null,"Use different secrets for your production environment (JWT, etc). Specify them using environment variables or a ",Object(a.b)("inlineCode",{parentName:"p"},".env")," file."),Object(a.b)("p",null,Object(a.b)("em",{parentName:"p"},".env (example)")),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"SETTINGS_JWT_SECRET=YZP0iv6gM+VBTxk61l8nKUno2QxsQHO9hm8XfeedZUw\n")),Object(a.b)("p",null,"You can generate 256-bit secrets encoded in base64 with the following command:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"foal createsecret\n")),Object(a.b)("h2",{id:"database-credentials--migrations"},"Database Credentials & Migrations"),Object(a.b)("p",null,"Use different credentials for your production database. Specify them using environment variables or a ",Object(a.b)("inlineCode",{parentName:"p"},".env")," file."),Object(a.b)("p",null,"If you use database migrations, run them on your production server with the following command:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"npm run migrations\n")),Object(a.b)("h2",{id:"files-to-upload"},"Files to Upload"),Object(a.b)("p",null,"If you install dependencies and build the app on the remote host, then you should upload these files:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"config/\normconfig.js\npackage-lock.json\npackage.json\npublic/ # this may depend on how the platform manages static files\nsrc/\ntsconfig.app.json\n")),Object(a.b)("p",null,"Then you will need to run ",Object(a.b)("inlineCode",{parentName:"p"},"npm install")," and ",Object(a.b)("inlineCode",{parentName:"p"},"npm run build"),"."),Object(a.b)("p",null,"If you install dependencies and build the app on your local host directly, then you should upload these files:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{className:"language-sh"}),"build/\nconfig/\nnode_modules/\normconfig.js\npackage-lock.json\npackage.json\npublic/ # this may depend on how the platform manages static files\n")))}s.isMDXComponent=!0},269:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var o=t(0),r=t.n(o);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,r=function(e,n){if(null==e)return{};var t,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)t=a[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=r.a.createContext({}),s=function(e){var n=r.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},u=function(e){var n=s(e.components);return r.a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},b=r.a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(t),b=o,m=u["".concat(i,".").concat(b)]||u[b]||d[b]||a;return t?r.a.createElement(m,c(c({ref:n},p),{},{components:t})):r.a.createElement(m,c({ref:n},p))}));function m(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var a=t.length,i=new Array(a);i[0]=b;var c={};for(var l in n)hasOwnProperty.call(n,l)&&(c[l]=n[l]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var p=2;p<a;p++)i[p]=t[p];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);